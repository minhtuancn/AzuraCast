services:
  web:
    container_name: azuracast
    image: ghcr.io/azuracast/azuracast:${AZURACAST_VERSION:-stable}

    labels:
      - com.centurylinklabs.watchtower.scope=azuracast

    ports:
      # ğŸ”‘ Port ná»™i bá»™ cho Coolify proxy (KHÃ”NG public)
      - "127.0.0.1:8088:80"

      # ğŸ§ Stream ports (3 stations)
      - "8000:8000"
      - "8001:8001"
      - "8002:8002"

      # ğŸ“ SFTP (giá»¯ náº¿u dÃ¹ng upload)
      - "2022:2022"

    # âŒ KHÃ”NG dÃ¹ng env_file trong Coolify
    # env_file:
    #   - azuracast.env
    #   - .env

    volumes:
      - station_data:/var/azuracast/stations
      - backups:/var/azuracast/backups
      - db_data:/var/lib/mysql

      - www_uploads:/var/azuracast/storage/uploads
      - geolite_install:/var/azuracast/storage/geoip
      - sftpgo_data:/var/azuracast/storage/sftpgo

    restart: unless-stopped

    ulimits:
      nofile:
        soft: 65536
        hard: 65536

    logging:
      options:
        max-size: "1m"
        max-file: "5"

volumes:
  db_data: {}
  station_data: {}
  backups: {}
  www_uploads: {}
  geolite_install: {}
  sftpgo_data: {}
